# Digital Signal Processing
数字信号处理课程学习及课程内容matlab实现代码<br>

---
参考书籍:<br>
1.《数字信号处理原理及其MATLAB实现（第3版） (Z-Library)》<br>
2.《MATLAB数字信号处理85个实用案例精讲.入门到进阶》<br>

---
运行环境:MATLAB R2023b<br>

## 目录
### 第二章
**2.1**:快速傅里叶变换的matlab函数<br>
>**注意**:
>y.'表示对矩阵y转置；y'表示对矩阵y共轭转置，不适用于复数矩阵。<br>

**2.3**:如何使实数序列时域上位移后为实数序列<br>

**2.4**:频谱图中频率刻度设置<br>
>**主要内容**:<br>
>将问题转化为频率分辨率计算<br>

**2.5**:计算信号幅值和初始相位<br>
>**主要内容**:<br>
>幅值A = 2*X(k0)/N<br>
>初始相位sita = arctan(X(k0))<br>
>**注意**:
>此处结果频率:55Hz、66Hz<br>
>原因:栅栏效应导致的细节缺失<br>
>解决方法:增多dft点数(补零)、提高频谱分辨率<br>
 

**2.7**:为什么fft后得到的频谱大部分为0<br>
>**注意**:
>在使用函数detrend对原信号进行消除趋势前，是否消除直流分量对结果影响不大<br>
>频谱中，f=0处表示直流分量<br>

**2.8** 如何把频谱图中纵坐标设置为分贝数<br>
>**主要内容**:<br>
>res = 20*lg(X(jw))<br>

**2.9** 同样进行矩形窗截断，为什么有的发生泄漏有的没有发生泄露<br>
>**注意**:
>matlab中使用函数构造窗函数时，注意窗函数序列为列向量<br>

**2.10** 加窗函数后频谱幅值变了，如何修正<br>
>**主要内容**:<br>
>幅值修正系数<br>
>汉宁窗hanning:2<br>
>海明窗hamming:1.852<br>
>布莱克曼窗blackman:2.381<br>
>矩形窗rectangular:1<br>

**2.11** 如何选择采样频率和信号长度 <br>
>**主要内容**:<br>
>频率分辨率df = fs/N <br>
>为满足两频率能被分辨，信号长度需满足N>=fs/(f1-f2)    <br>

**2.12** FFT中的补零问题 <br>
>**主要内容**:<br>
>根据fft原理可知，当采样点数为2的幂次时，fft效率最高,即采样点数 N = 2^k <br>
>根据案例2.9可知，补零将造成频谱泄露 <br>

**2.13** 能否用循环相关计算延迟量<br>
>**主要内容**:<br>
>两信号可以使用互相关计算得到延迟量，使用线性相关函数；而使用fft可以快速计算循环相关，从而得到延迟量 <br>
>两信号x(n),y(n)；长度分别为N和M，则有卷积后信号长度N' = N + M -1  <br>
>两信号x(n),y(n)；长度分别为N和M，若进行N' > N + M -1 点循环卷积，则结果与线性卷积一致；  <br>
>若进行N' > N + M -1点循环卷积，则产生混叠。 <br>
>**注意**:
>1.函数ifftshift将数据从中间分割，将右侧半部分移至左侧<br>
>2.函数fftshift将数据从中间分割，将左侧半部分移至右侧<br>
>3.当数据为奇数个，fftshift和ifftshift效果不相同；当数据为偶数个，fftshift和>ifftshift效果相同。<br>
>A=[1,2,3,4,5]; <br>
>B=fftshift(A)=[4,5,1,2,3];<br>
>C=ifftshift(A)=[3,4,5,1,2];<br>

### 第三章
**3.1**:巴特沃斯，切比雪夫Ⅰ、Ⅱ，椭圆形滤波器相同和不同点<br>
>**主要内容**:<br>
>'s'表示模拟滤波器    <br>
>1.滤波器参数计算   <br>
>[n,wn] = buttord(wp,ws,Rp,Rs,'s')    <br>
>n:模拟滤波器最低阶数   <br>
>wn:等效低通滤波器截止频率   <br>
>wp:滤波器通带频率   <br>
>ws:滤波器阻带频率<br>
>Rp:通带波纹起伏<br>
>Rs:阻带波纹起伏<br>
>buttord cheb1ord cheb2ord ellipord <br>
>2.滤波器原型设计<br>
>[b,a] = butter(n,wn,'ftype','s');巴特沃斯滤波器设计<br>
>[b,a] = cheby1(n,Rp,wn,'ftype','s');切比雪夫Ⅰ滤波器设计<br>
>[b,a] = cheby2(n,Rs,wn,'ftype','s');切比雪夫Ⅱ滤波器设计<br>
>[b,a] = ellip(n,Rp,Rs,wn,'ftype','s');椭圆形滤波器设计<br>
>b,a:滤波器传递函数系数<br>
>ftype:滤波器类型('low'低通、'high'高通、'bandpass'带通、'stop'带阻)<br>
>3.滤波器幅频响应曲线<br>
>[A,W] = freqs(b,a,w);<br>
>A:幅度响应<br>
>W:频率响应<br>
>w:角频率频点(rad/s)<br>
>不设置w默认计算200个点<br>

**3.2**:设置模拟滤波器的几种编程方法相同和不同点<br>
>**主要内容**:<br>
>1.模拟滤波器原型设计<br>
>[z,p,k] = buttap(N)<br>
>z、p、k:模拟滤波器极点、零点、增益<br>
>n:滤波器阶数<br>
>buttap cheb1lap cheb2lap ellipap <br>
>2.传递函数计算<br>
>(1)低通变带通<br>
>   [b,a] = zp2tf(z,p,k) <br>
>   [bt,at] = lp2bp(b,a,Wo,Bw)<br>
>(2)低通变高通<br>
>   [b,a] = zp2tf(z,p,k) <br>
>   [bt,at] = lp2hp(b,a,Wo)<br>
>(3)低通变带阻<br>
>   [b,a] = zp2tf(z,p,k) <br>
>   [bt,at] = lp2bs(b,a,Wo,Bw)<br>
>(4)低通变低通<br>
>   [b,a] = zp2tf(z,p,k) <br>
>   [bt,at] = lp2lp(b,a,Wo)<br>
>bt,at:滤波器传递函数系数<br>
>Wo = sqrt(W1*W2) 中心频率<br>
>Bw = W1-W2 带宽<br>

**3.3**:在频带变换的模拟滤波器中,怎么计算Wo和Bw<br>

**3.4**:用留数求得脉冲不变法数字滤波器与调用impinvar函数得到的是否一样<br>
>**主要内容**:<br>
>1.零极点计算<br>
>[r,p,k] = residuez(B,A)<br>
>[B,A] = residuesz(r,p,k)<br>
>r,p,k:零点、极点、增益<br>
>B,A:传递函数系数<br>
>2.传递函数模拟系数转数字系数<br>
>[bz,az] = impinvar(b,a,fs)<br>
>bz,az:模拟系统传递函数系数<br>
>b,a:模拟系统传递函数系数<br>
>fs:采样频率,不输入默认为1Hz<br>
>3.脉冲响应计算<br>
>(1)模拟系统脉冲响应计算<br>
>h = impulse(b,a,t)<br>
>h:脉冲响应<br>
>t:时间序列<br>
>(2)离散系统脉冲响应计算<br>
>h = impz(bz,az,n,fs)<br>
>n:脉冲响应样点总数<br>

>**注意**:<br>
>plot(t,h\*T)中h*t是为了平衡采样过程中幅值变化(补偿频域1/T缩放)<br>
>函数[r,p,k] = residue(bs,as);中r为留数<br>
>数字系统留数结果rz = r*T,补偿频域1/T缩放<br>

**3.5**:在调用bilinear函数时为何有的fs用实际频率值，有的用fs = 1<br>
>**主要内容**:<br>
>1.双线性变换法模拟到数字变换<br>
>[bz,az] = bilinear(b,a,fs)<br>
>[zd,pd,kd] = bilinear(z,p,k,fs)<br>
>b,a:模拟系统传递函数系数<br>
>bz,az:数字系统传递函数系数<br>
>z,p,k:模拟系统零极点、增益<br>
>zd,pd,kd:数字系统零极点、增益<br>
>
>2.数字滤波器幅频响应曲线<br>
>[H,w] = freqz(b,a,n)<br>
>[H,f] = freqz(b,a,n,fs)<br>
>w:归一化角频率,[0,pi]<br>
>f:频率<br>
>n:计算长度<br>

**3.6**:为什么不能用impinvar函数<br>
>**主要内容**:<br>
>使用脉冲响应不变法，在奈奎斯特频率附近会产生混叠，且由于模拟滤波器选择不合理会导致阻带衰减不够<br>
>因此应选择双线性变换法和陡峭的高阶椭圆滤波器<br>

**3.7**:为什么滤波器的输出会溢出或没有数值<br>
>**主要内容**:<br>
>若低通滤波器截止频率或带通滤波器中心频率相对采样频率过低(即fc/fs过小)或过渡带太窄时产生这种情况<br>
>解决方法:降低采样频率，fs'/fc < 15比较合适<br>
>
>1.降采样 <br>
>x = resample(y,p,q);<br>
>y:输入信号<br>
>p,q:信号以fs*p/q的采样频率进行重新采样<br>
>**注意**:<br>
>使用数字域直接计算滤波器参数时(滤波器函数不加's'):<br>
>1.角频率wp = 2*fp/fs1;通带角频率ws = 2*fw/fs1;  阻带角频率<br>
>2.使用对应滤波器函数进行设计(滤波器函数不加's')<br>
>使用模拟域计算滤波器参数时(滤波器函数加's'):<br>
>1.角频率wp = 2*pi*fp/fs1;  通带角频率ws = 2*pi*fw/fs1;  阻带角频率<br>
>2.频率预畸变<br>
>3.双线性变换处理<br>
>4.使用模拟与计算滤波器函数时必须进行脉冲响应不变法或双线性变换法处理<br>

**3.8**:使用bilinear函数时，如果Wp和Ws没进行预畸变会有什么结果<br>
>**主要内容**:<br>
>W = (2/T)*tan(w/2),所以当w/2较小时，W ≈ w/T，当T = 1时，W ≈ w，因此可能影响较小<br>
>当w->pi时w/2->pi/2,此时影响较大<br>
>**注意**:<br>
>[A3,W3] = freqs(b1,a1);  巴特沃斯模拟滤波器频率响应<br>
>使用时注意W3输出为角频率<br>