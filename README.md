# Digital Signal Processing
数字信号处理课程学习及课程内容matlab实现代码<br>

---
参考书籍:<br>
1.《数字信号处理原理及其MATLAB实现（第3版） (Z-Library)》<br>
2.《MATLAB数字信号处理85个实用案例精讲.入门到进阶》<br>

---
运行环境:MATLAB R2023b<br>

## 目录
### 第二章
**2.1**:快速傅里叶变换的matlab函数<br>
>**注意**:
>y.'表示对矩阵y转置；y'表示对矩阵y共轭转置，不适用于复数矩阵。<br>

**2.3**:如何使实数序列时域上位移后为实数序列<br>

**2.4**:频谱图中频率刻度设置<br>
>**主要内容**:<br>
>将问题转化为频率分辨率计算<br>

**2.5**:计算信号幅值和初始相位<br>
>**主要内容**:<br>
>幅值A = 2\*X(k0)/N<br>
>初始相位sita = arctan(X(k0))<br>
>**注意**:
>此处结果频率:55Hz、66Hz<br>
>原因:栅栏效应导致的细节缺失<br>
>解决方法:增多dft点数(补零)、提高频谱分辨率<br>
 

**2.7**:为什么fft后得到的频谱大部分为0<br>
>**注意**:
>在使用函数detrend对原信号进行消除趋势前，是否消除直流分量对结果影响不大<br>
>频谱中，f=0处表示直流分量<br>

**2.8** 如何把频谱图中纵坐标设置为分贝数<br>
>**主要内容**:<br>
>res = 20\*lg(X(jw))<br>

**2.9** 同样进行矩形窗截断，为什么有的发生泄漏有的没有发生泄露<br>
>**注意**:
>matlab中使用函数构造窗函数时，注意窗函数序列为列向量<br>

**2.10** 加窗函数后频谱幅值变了，如何修正<br>
>**主要内容**:<br>
>幅值修正系数<br>
>汉宁窗hanning:2<br>
>海明窗hamming:1.852<br>
>布莱克曼窗blackman:2.381<br>
>矩形窗rectangular:1<br>

**2.11** 如何选择采样频率和信号长度 <br>
>**主要内容**:<br>
>频率分辨率df = fs/N <br>
>为满足两频率能被分辨，信号长度需满足N>=fs/(f1-f2)    <br>

**2.12** FFT中的补零问题 <br>
>**主要内容**:<br>
>根据fft原理可知，当采样点数为2的幂次时，fft效率最高,即采样点数 N = 2^k <br>
>根据案例2.9可知，补零将造成频谱泄露 <br>

**2.13** 能否用循环相关计算延迟量<br>
>**主要内容**:<br>
>两信号可以使用互相关计算得到延迟量，使用线性相关函数；而使用fft可以快速计算循环相关，从而得到延迟量 <br>
>两信号x(n),y(n)；长度分别为N和M，则有卷积后信号长度N' = N + M -1  <br>
>两信号x(n),y(n)；长度分别为N和M，若进行N' > N + M -1 点循环卷积，则结果与线性卷积一致；  <br>
>若进行N' > N + M -1点循环卷积，则产生混叠。 <br>
>**注意**:
>1.函数ifftshift将数据从中间分割，将右侧半部分移至左侧<br>
>2.函数fftshift将数据从中间分割，将左侧半部分移至右侧<br>
>3.当数据为奇数个，fftshift和ifftshift效果不相同；当数据为偶数个，fftshift和>ifftshift效果相同。<br>
>A=[1,2,3,4,5]; <br>
>B=fftshift(A)=[4,5,1,2,3];<br>
>C=ifftshift(A)=[3,4,5,1,2];<br>

### 第三章
**3.1**:巴特沃斯，切比雪夫Ⅰ、Ⅱ，椭圆形滤波器相同和不同点<br>
>**主要内容**:<br>
>'s'表示模拟滤波器    <br>
>1.滤波器参数计算   <br>
>[n,wn] = buttord(wp,ws,Rp,Rs,'s')    <br>
>n:模拟滤波器最低阶数   <br>
>wn:等效低通滤波器截止频率   <br>
>wp:滤波器通带频率   <br>
>ws:滤波器阻带频率<br>
>Rp:通带波纹起伏<br>
>Rs:阻带波纹起伏<br>
>buttord cheb1ord cheb2ord ellipord <br>
>2.滤波器原型设计<br>
>[b,a] = butter(n,wn,'ftype','s');巴特沃斯滤波器设计<br>
>[b,a] = cheby1(n,Rp,wn,'ftype','s');切比雪夫Ⅰ滤波器设计<br>
>[b,a] = cheby2(n,Rs,wn,'ftype','s');切比雪夫Ⅱ滤波器设计<br>
>[b,a] = ellip(n,Rp,Rs,wn,'ftype','s');椭圆形滤波器设计<br>
>b,a:滤波器传递函数系数<br>
>ftype:滤波器类型('low'低通、'high'高通、'bandpass'带通、'stop'带阻)<br>
>3.滤波器幅频响应曲线<br>
>[A,W] = freqs(b,a,w);<br>
>A:幅度响应<br>
>W:频率响应<br>
>w:角频率频点(rad/s)<br>
>不设置w默认计算200个点<br>

**3.2**:设置模拟滤波器的几种编程方法相同和不同点<br>
>**主要内容**:<br>
>1.模拟滤波器原型设计<br>
>[z,p,k] = buttap(N)<br>
>z、p、k:模拟滤波器极点、零点、增益<br>
>n:滤波器阶数<br>
>buttap cheb1lap cheb2lap ellipap <br>
>2.传递函数计算<br>
>(1)低通变带通<br>
>   [b,a] = zp2tf(z,p,k) <br>
>   [bt,at] = lp2bp(b,a,Wo,Bw)<br>
>(2)低通变高通<br>
>   [b,a] = zp2tf(z,p,k) <br>
>   [bt,at] = lp2hp(b,a,Wo)<br>
>(3)低通变带阻<br>
>   [b,a] = zp2tf(z,p,k) <br>
>   [bt,at] = lp2bs(b,a,Wo,Bw)<br>
>(4)低通变低通<br>
>   [b,a] = zp2tf(z,p,k) <br>
>   [bt,at] = lp2lp(b,a,Wo)<br>
>bt,at:滤波器传递函数系数<br>
>Wo = sqrt(W1\*W2) 中心频率<br>
>Bw = W1-W2 带宽<br>

**3.3**:在频带变换的模拟滤波器中,怎么计算Wo和Bw<br>

**3.4**:用留数求得脉冲不变法数字滤波器与调用impinvar函数得到的是否一样<br>
>**主要内容**:<br>
>1.零极点计算<br>
>[r,p,k] = residuez(B,A)<br>
>[B,A] = residuesz(r,p,k)<br>
>r,p,k:零点、极点、增益<br>
>B,A:传递函数系数<br>
>2.传递函数模拟系数转数字系数<br>
>[bz,az] = impinvar(b,a,fs)<br>
>bz,az:模拟系统传递函数系数<br>
>b,a:模拟系统传递函数系数<br>
>fs:采样频率,不输入默认为1Hz<br>
>3.脉冲响应计算<br>
>(1)模拟系统脉冲响应计算<br>
>h = impulse(b,a,t)<br>
>h:脉冲响应<br>
>t:时间序列<br>
>(2)离散系统脉冲响应计算<br>
>h = impz(bz,az,n,fs)<br>
>n:脉冲响应样点总数<br>

>**注意**:<br>
>plot(t,h\*T)中h\*t是为了平衡采样过程中幅值变化(补偿频域1/T缩放)<br>
>函数[r,p,k] = residue(bs,as);中r为留数<br>
>数字系统留数结果rz = r\*T,补偿频域1/T缩放<br>

**3.5**:在调用bilinear函数时为何有的fs用实际频率值，有的用fs = 1<br>
>**主要内容**:<br>
>1.双线性变换法模拟到数字变换<br>
>[bz,az] = bilinear(b,a,fs)<br>
>[zd,pd,kd] = bilinear(z,p,k,fs)<br>
>b,a:模拟系统传递函数系数<br>
>bz,az:数字系统传递函数系数<br>
>z,p,k:模拟系统零极点、增益<br>
>zd,pd,kd:数字系统零极点、增益<br>
>
>2.数字滤波器幅频响应曲线<br>
>[H,w] = freqz(b,a,n)<br>
>[H,f] = freqz(b,a,n,fs)<br>
>w:归一化角频率,[0,pi]<br>
>f:频率<br>
>n:计算长度<br>

**3.6**:为什么不能用impinvar函数<br>
>**主要内容**:<br>
>使用脉冲响应不变法，在奈奎斯特频率附近会产生混叠，且由于模拟滤波器选择不合理会导致阻带衰减不够<br>
>因此应选择双线性变换法和陡峭的高阶椭圆滤波器<br>

**3.7**:为什么滤波器的输出会溢出或没有数值<br>
>**主要内容**:<br>
>若低通滤波器截止频率或带通滤波器中心频率相对采样频率过低(即fc/fs过小)或过渡带太窄时产生这种情况<br>
>解决方法:降低采样频率，fs'/fc < 15比较合适<br>
>
>1.降采样 <br>
>x = resample(y,p,q);<br>
>y:输入信号<br>
>p,q:信号以fs\*p/q的采样频率进行重新采样<br>
>**注意**:<br>
>使用数字域直接计算滤波器参数时(滤波器函数不加's'):<br>
>1.角频率wp = 2\*fp/fs1;通带角频率ws = 2\*fw/fs1;  阻带角频率<br>
>2.使用对应滤波器函数进行设计(滤波器函数不加's')<br>
>使用模拟域计算滤波器参数时(滤波器函数加's'):<br>
>1.角频率wp = 2\*pi\*fp/fs1;  通带角频率ws = 2\*pi\*fw/fs1;  阻带角频率<br>
>2.频率预畸变<br>
>3.双线性变换处理<br>
>4.使用模拟与计算滤波器函数时必须进行脉冲响应不变法或双线性变换法处理<br>

**3.8**:使用bilinear函数时，如果Wp和Ws没进行预畸变会有什么结果<br>
>**主要内容**:<br>
>W = (2/T)*tan(w/2),所以当w/2较小时，W ≈ w/T，当T = 1时，W ≈ w，因此可能影响较小<br>
>当w->pi时w/2->pi/2,此时影响较大<br>
>**注意**:<br>
>[A3,W3] = freqs(b1,a1);  巴特沃斯模拟滤波器频率响应<br>
>使用时注意W3输出为角频率<br>

**3.9**:如何把任意s系统转换为z系统<br>
>**主要内容**:<br>
>通过脉冲响应不变法或双线性变换法将模拟系统转换为数字系统<br>
>1.计算多项式系数<br>
>b = sym2poly(y)<br>
>y:多项式<br>


**3.10**:把滤波器的滤波过程用差分方程的运算来完成<br>
>**主要内容**:<br>
>生成椭圆形滤波器处理该问题<br>


**3.11**:滤波函数filter中zi、zf有何作用<br>
>**主要内容**:<br>
>[y,zf] = filter(a,b,x,zi);<br>
>zi:初始条件<br>
>zf:下一阶段初始条件<br>
>zi、zf用于滤波过程中信号分段问题的处理<br>
>初始条件zi长度必须为 max(length(a),length(b))-1<br>

**3.12**:如何使用数字陷波器滤除工频信号<br>
>**主要内容**:<br>
>1.数字陷波器设计<br>
>[b,a] = iirnotch[Wo,Bw];<br>
>Wo:数字陷波器中心频率<br>
>Bw:数字陷波器带宽<br>

>**注意**:<br>
>Wo、Bw使用归一化频率<br>


**3.13**:如何设计数字全通滤波器对IIR滤波器进行相位补偿<br>
>**主要内容**:<br>
>由于IIR滤波器相移为非线性，因此可以在IIR滤波器后级联一个全通滤波器调整输出信号相移<br>
>群延时:滤波器对某一频率成分的延时效果<br>
>1.群延时计算<br>
>[gd,w] = grpdelay(b,a,n);<br>
>[gd,f] = grpdelay(b,a,n,fs);<br>
>b,a:数字滤波器系数<br>
>n:计算点数,默认512点<br>
>fs:采样频率<br>
>f:输出频率序列<br>
>w:输出角频率序列<br>
>gd:延迟量曲线<br>
>2.全相位数字滤波器设计<br>
>设计一个在已知频率范围内接近规定群延迟的全相位数字滤波器<br>
>[b,a] = iirgrpdelay(N,F,Gd)<br>
>F、Gd:群延迟指标<br>
>b、a:数字滤波器系数<br>
>N:全通滤波器阶数(必须是偶数)<br>

**3.14**:为什么零相位滤波在起始和结束两端都受瞬态效应的影响<br>
>**主要内容**:<br>
>零相位滤波输入输出信号同相<br>
>由于起始段受瞬态效应影响，时域翻转后，后一项结束端为前一项起始端，因此起始和结束两端都受瞬态效应的影响<br>
>1.零相位数字滤波器设计<br>
>y = filtfilt(b,a,x);<br>

**3.15**:在窗函数法设计FIR滤波器中如何选择窗函数和阶数N<br>
>**主要内容**:<br>
>不同窗函数阻带最小衰减不同, 窗函数选择主要取决于阻带衰减(Rs)要求<br>
>滤波器阶数N与窗函数有关,并根据窗函数、通带频率、阻带频率进行计算<br>
>fs - fp = dw/N 或 min(Δf1,Δf2) = dw/N<br>
>其中dw取决于选择的窗函数 <br>
>fir滤波器截止频率计算：<br>
>fc = (fp + fs)/2<br>
>1.窗函数设计fir滤波器<br>
>B = fir1(n,Wn,'ftype',windows)<br>
>B:滤波器系数序列 <br>
>n:滤波器阶数<br>
>Wn:滤波器带宽<br>
>window:窗函数序列,长度为n+1(滤波器阶数+1)<br>

**3.16**:用ideal_lp函数和fir1函数设计的滤波器是否相同<br>
>**主要内容**:<br>
>1.理想低通滤波器<br>
>给出一个理想FIR滤波器的脉冲响应序列<br>
>hd = ideal_lp(wc,M);<br>
>hd:理想低通滤波器脉冲响应序列<br>
>wc = fc\*2\*pi/fs ：归一化截止角频率<br>
>2.各种窗函数dw值:<br>
>矩形窗(21dB):1.8\*pi<br>
>汉宁窗(44dB):6.2\*pi<br>
>海明窗(53dB):6.6\*pi<br>
>布莱克曼窗(74dB):11\*pi<br>
>凯泽窗(80dB):10\*pi<br>

**3.17**:凯泽窗设计fir滤波器优点<br>
>**主要内容**:<br>
>不同beta值凯泽窗有不同形状(过渡带宽、通带波纹、阻带波纹)<br>
>Rp = 3;Rs = 50;选择beta = 4.538;过渡带宽 Δf = 5.86\*pi/N<br>
>1.凯泽窗设计滤波器<br>
>用凯泽窗求FIR滤波器阶数和凯泽窗参数<br>
>[n,Wn,beta,ftype] = kaiserord(f,A,dev,fs);<br>
>[n,Wn,beta,ftype] = kaiserord(f,A,dev);<br>
>f:频率参数[fp fs]或[fs1 fp1 fs2 fp2]<br>
>a:滤波器幅值矢量 低通:[1 0],带通:[0 1 0]<br>
>dev:通带、阻带波纹线性值<br>
>n:滤波器阶数<br>
>Wn:滤波器频率参数<br>
>2.dev数值计算<br>
>参考数字信号处理7.3.5 p414 式7.3.47 、7.3.48<br>
>delta1 = (10^(Rp/20)-1)/(10^(Rp/20)+1);<br>
>delta2 = 10^(-Rs/20)/(1-10^(-Rs/20));<br>

**3.18**:为什么FIR滤波器不适合设计数字陷波器<br>
>**主要内容**:<br>
>过渡带宽 Δf = dw/N,由于数字陷波器幅频响应特点,dw固定,Δf越小,滤波器阶数N越大,不适用于设计数字陷波器<br>

**3.19**:通过FIR滤波器的输出,延迟量如何矫正<br>
>**主要内容**:<br>
>通过群延迟计算延迟量进行修正,在时间域上消除(N-1)/2个样点进行延迟量矫正<br>
>**注意**:<br>
>通过群延迟计算延迟量进行修正,在时间域上消除(N-1)/2个样点进行延迟量矫正<br>

**3.20**:通过fir2函数设计任意响应滤波器<br>
>**主要内容**:<br>
>1.频率采样法设计FIR滤波器
>B = fir2(n,f,a,window);<br>
>B:滤波器输出<br>
>n:滤波器阶数<br>
>f:频点值<br>
>a:对应频点幅值<br>
>window:窗函数,默认使用海明窗<br>
>**注意**:<br>
>fir2函数使用归一化频点<br>

**3.21**:通过firpm设计等波纹fir滤波器<br>
>**主要内容**:<br>
>1.等波纹fir滤波器设计<br>
>b = firpm(n,f,a,w);<br>
>b:滤波器输出<br>
>n:滤波器阶数<br>
>f:频点值<br>
>a:对应频点幅度<br>
>w:计权矢量<br>
>2.等波纹fir滤波器参数计算<br>
>[n,fo,ao,w] = firpmord(f,a,dev,fs);<br>
>n、fo、ao、w:firpm函数输入参数<br>
>f:频点值<br>
>a:幅值矢量<br>
>dev:理想滤波器偏差值矢量<br>
>**注意**:<br>
>firpm中f为归一化频率矢量,firpmord中若无fs输入,得到的fo为归一化频率矢量<br>
>因此在使用firpmord计算firpm所用参数时不使用fs<br>

**3.22**:如何设计多频段FIR滤波器<br>
>**主要内容**:<br>
>通过fir2函数和等波纹法设计FIR多频带滤波器<br>
>**注意**:<br>
>fir2函数中a长度与频点f长度相同<br>
>firpm中频点f的长度为2*length(a)-2<br>

**3.23**:如何使用FIR滤波器设计数字微分器<br>
>**主要内容**:<br>
>firpm函数设计数字微分器<br>


**3.24**:如何使用FIR滤波器设计希尔伯特变换器<br>
>**主要内容**:<br>
>firpm函数设计希尔伯特变换器<br>